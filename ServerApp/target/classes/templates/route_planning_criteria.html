<!DOCTYPE HTML>
<html lang="pl-PL" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Getting Started: Serving Web Content</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="../static/css/style.css" th:href="@{/css/sections.css}" rel="stylesheet"/>

    <script>
        /*<![CDATA[*/
        var mountainRanges = null;
        var mountainGroups = null;
        var data = [];

        var localizationsList = [];

        function changeMountainRangesListener() {
            var mountainRangesSelector = document.getElementById("mountainRangesSelectList");
            var mountainGroupsSelector = document.getElementById("mountainGroupsSelectList");

            console.log(mountainRangesSelector.innerHTML);
            var length = mountainGroupsSelector.options.length;
            for (i = 0; i < length; i++) {
                mountainGroupsSelector.options[i] = null;
            }

            length = data.length;
            for (i = 0; i < length; i++) {
                console.log(typeof data[i].mountainRange.id);
                console.log(data[i].mountainRange.id);
                console.log(typeof mountainRangesSelector.options.selectedIndex);
                console.log(mountainRangesSelector.options.selectedIndex);
                console.log(data[i].mountainRange.id == mountainRangesSelector.options.selectedIndex);
                if (data[i].mountainRange.id == mountainRangesSelector.options.selectedIndex) {
                    console.log("aaaadddd");
                    var option = document.createElement("option");
                    option.text = data[i].name;
                    option.value = data[i].id;
                    mountainGroupsSelector.add(option);
                }
            }

            console.log(data);
        }

        /*]]>*/
    </script>

    <script th:each="item:${mountainGroups}" th:inline="javascript">
        data.push([[${item}]]);
    </script>

</head>
<body>


<script>
    /*<![CDATA[*/
    mountainRanges = "[[${mountainRanges}]]";
    mountainGroups = "[[${mountainGroups}]]";
    console.log(mountainRanges);
    console.log(mountainGroups);
    /*]]>*/
</script>

<form action="#" th:action="@{/route/find}" method="post">
    <table>
        <tr>
            <td>Pasmo górskie</td>
            <td>
                <select id="mountainRangesSelectList" name="mountainRange" onchange="changeMountainRangesListener();">
                    <option></option>
                    <option th:each="mr : ${mountainRanges}"
                            th:value="${mr.getId()}" th:text="${mr.getName()}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Grupa górska</td>
            <td>
                <select id="mountainGroupsSelectList" name="mountainGroup">
                    <option></option>
                    <option th:each="mg : ${mountainGroups}"
                            th:value="${mg.getId()}" th:text="${mg.getName()}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Lokalizacja startowa</td>
            <td>
                <select name="locationStart">
                    <option></option>
                    <option th:each="l : ${locations}"
                            th:value="${l.getId()}" th:text="${l.getName()}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Lokalizacja końcowa</td>
            <td>
                <select name="locationFinish">
                    <option></option>
                    <option th:each="l : ${locations}"
                            th:value="${l.getId()}" th:text="${l.getName()}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <div>Lokalizacje pośrednie</div>
                <div>
                    <select id="otherLocations" name="otherLocation">
                        <option></option>
                        <option th:each="l : ${locations}"
                                th:value="${l.getId()}" th:text="${l.getName()}"></option>
                    </select>
                </div>
            </td>
            <td>
                <a href="javascript:add()">href</a>
                <script type="text/javascript">
                    // $.ajax({
                    //     type : "POST",
                    //     url : "/myurl",
                    //     data : {
                    //         myArray: a //notice that "myArray" matches the value for @RequestParam
                    //                    //on the Java side
                    //     },
                    //     success : function(response) {
                    //         // do something ...
                    //     },
                    //     error : function(e) {
                    //         alert('Error: ' + e);
                    //     }
                    // });
                    function add(){
                        var otherLocations = document.getElementById("otherLocations");
                        var tr = document.createElement("tr");
                        var td = document.createElement("td");
                        console.log(otherLocations);
                        td.innerText = otherLocations.options[otherLocations.selectedIndex].text;
                        tr.appendChild(td);
                        document.getElementById("other_locations").appendChild(tr);
                        localizationsList.push(otherLocations.options[otherLocations.selectedIndex].value);
                    }
                </script>
                <table id="other_locations">
                    <!--<tr>-->
                        <!--<td>jsdklajfkldsa</td>-->
                    <!--</tr>-->
                    <!--<tr>-->
                        <!--<td>jsdklajfkldsa</td>-->
                    <!--</tr>-->
                    <!--<tr>-->
                        <!--<td>jsdklajfkldsa</td>-->
                    <!--</tr>-->
                    <!--<tr>-->
                        <!--<td>jsdklajfkldsa</td>-->
                    <!--</tr>-->
                    <!--<tr>-->
                        <!--<td>jsdklajfkldsa</td>-->
                    <!--</tr>-->
                </table>
            </td>
        </tr>
        <tr>
            <td>Punkty za odległość</td>
            <td><input name="pointsDistance" type="number"></td>
        </tr>
        <tr>
            <td>Punkty za wysokość</td>
            <td><input name="pointsAltitude" type="number"></td>
        </tr>
    </table>
    <input type="submit" value="Znajdź">
</form>
<p>
    <!--<a href="../home.html" th:href="@{/}">Return to home</a>-->
</p>
</body>
</html>