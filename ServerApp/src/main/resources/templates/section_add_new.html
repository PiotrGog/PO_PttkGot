<!DOCTYPE HTML>
<html lang="pl-PL" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <title>Getting Started: Serving Web Content</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="../static/css/style.css" th:href="@{/css/style.css}" type="text/css" rel="stylesheet"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--<script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>-->
    <!--<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/additional-methods.min.js"></script>-->
    <!--<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>-->
    <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>-->
    <!--<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-form-validator/2.3.26/jquery.form-validator.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/additional-methods.js"></script>
    <script>
        /*<![CDATA[*/
        var mountainRanges = null;
        var mountainGroups = null;
        var data = [];

        function changeMountainRangesListener() {
            var mountainRangesSelector = $("#mountainRangesSelectList");
            var mountainGroupsSelector = $("#mountainGroupsSelectList");

            mountainGroupsSelector.find('option')
                .remove()
                .end();

            var option = new Option("", "", true, true);
            mountainGroupsSelector.append(option);

            length = data.length;
            for (i = 0; i < length; i++) {
                console.log(data[i].mountainRange.id);
                console.log(mountainRangesSelector.val());
                if (data[i].mountainRange.id == mountainRangesSelector.val()) {
                    console.log("aaaadddd");
                    option = new Option(data[i].name, data[i].id, false, false);
                    mountainGroupsSelector.append(option);
                }
            }
        }

        /*]]>*/
    </script>

    <script th:each="item:${mountainGroups}" th:inline="javascript">
        data.push([[${item}]]);
    </script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.js">
        $(document).ready(function () {
            $("#new_section_form").on('submit', function (e) {

                var errorBox = $("#error_message");
                // errorBox.cleanData();
                var errorText = "";
                e.preventDefault();
                alert("submit");
                var validatiorCorrect = true;
                if ($("#mountainRangesSelectList").val() === "") {
                    validatiorCorrect = false;
                    errorText += "Wypełnij pole 'Pasmo górskie'<\/br>";

                }
                if ($("#mountainGroupsSelectList").val() === "") {
                    validatiorCorrect = false;
                    errorText += "Wypełnij pole 'Grupa górska'<\/br>";

                }
                if ($("#locationOne").val() === "") {
                    validatiorCorrect = false;
                    errorText += "Wypełnij pole 'Lokalizacja pierwsza'<\/br>";

                }
                if ($("#locationTwo").val() === "") {
                    validatiorCorrect = false;
                    errorText += "Wypełnij pole 'Lokalizacja druga'<\/br>";

                }
                if ($("#distance").val() === "") {
                    validatiorCorrect = false;
                    errorText += "Wypełnij pole 'Odległość'<\/br>";

                }
                if ($("#locationTwo").val() === "") {
                    validatiorCorrect = false;
                    errorText += "Wypełnij pole 'Punkty za wysokość'<\/br>";

                }
                if ($("#locationTwo").val() === "") {
                    validatiorCorrect = false;
                    errorText += "Wypełnij pole 'Punkty za odległość'<\/br>";

                }


                errorBox.html(errorText);
                if(validatiorCorrect) {
                    this.submit();
                }
            });
        });
    </script>

</head>
<body>


<script>
    /*<![CDATA[*/
    mountainRanges = "[[${mountainRanges}]]";
    mountainGroups = "[[${mountainGroups}]]";
    console.log(mountainRanges);
    console.log(mountainGroups);
    /*]]>*/
</script>

<p class="header">
    <img class="header" src="../static/images/pttk_logo.jpg" th:src="@{/images/pttk_logo.jpg}" width="100"
         alt="Logo Pttk">
    Dodaj odcinek punktowany do GOT
    <a style="float: right;" href="/sections/" class="button_grey">Anuluj</a>
</p>

<form id="new_section_form" th:action="@{/sections/addSection}" method="post">
    <table class="sections_details">
        <tr>
            <td class="align_right">Pasmo górskie:</td>
            <td>
                <select class="select_section_param" id="mountainRangesSelectList" name="mountainRange"
                        onchange="changeMountainRangesListener();">
                    <option th:each="mr : ${mountainRanges}"
                            th:value="${mr.getId()}"
                            th:text="${mr.getName()}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="align_right">Grupa górska:</td>
            <td>
                <select class="select_section_param" id="mountainGroupsSelectList" name="mountainGroup">
                    <option th:each="mg : ${mountainGroups}"
                            th:value="${mg.getId()}"
                            th:text="${mg.getName()}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="align_right">Lokalizacja pierwsza:</td>
            <td>
                <select class="select_section_param" name="locationOne" id="locationOne">
                    <option th:each="l : ${locations}"
                            th:value="${l.getId()}" th:text="${l.getName()}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="align_right">Lokalizacja druga:</td>
            <td>
                <select class="select_section_param" name="locationTwo" id="locationTwo">
                    <option th:each="l : ${locations}"
                            th:value="${l.getId()}" th:text="${l.getName()}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="align_right">Odległość:</td>
            <td>
                <input class="select_section_param" name="distance" id="distance" type="number">
            </td>
        </tr>
        <tr>
            <td class="align_right">Punkty za wysokość:</td>
            <td>
                <select class="select_section_param" name="pointsAltitude" id="pointsAltitude">
                    <option th:each="i : ${#numbers.sequence(0, 20)}" th:value="${i}" th:text="${i}"
                            th:selected="${i==1}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="align_right">Punkty za odległość:</td>
            <td>
                <select class="select_section_param" name="pointsDistance" id="pointsDistance">
                    <option th:each="i : ${#numbers.sequence(0, 20)}" th:value="${i}" th:text="${i}"
                            th:selected="${i==1}"></option>
                </select>
            </td>
        </tr>
        <tr>
            <td>
            </td>
            <td>

                <input class="select_section_param" type="submit" value="Dodaj">
                <!--<input id="submit_button" class="select_section_param" type="button" value="Dodaj">-->
            </td>
        </tr>
    </table>
</form>
<p class="error_box" id="error_message">ddddddddddddddd</p>

<script>
    changeMountainRangesListener();
</script>

</body>
</html>